<!-- thread.html -->

<head>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<h1>Talk & talk</h1>

{% with notifications = get_flashed_messages() %}
  {% if notifications %}
    {% for message in notifications %}
      <div style="color: red; font-size: 20px">
        {{ message }}
      </div>
    {% endfor %}
  {% endif %}
{% endwith %}

<form action="/logout" method="post">
  logged in as {{username}} <button type="submit">Logout</button>
</form>

<h2>Thread {{thread_title}}</h2>

<h3>Messages</h3>

<div class="messages-container">
  {% for message in messages %}
    <div class="message-card">
      <div class="message-header">
        <strong class="message-username">{{ message.username }}</strong><span class="said-text"> said:</span>
      </div>    
      <p>{{ message.content }}</p>
      {% if message.posted_by == session['user_id'] %}
        <form action="/edit_message/{{ message.id }}" method="post" class="message-form">
          <textarea name="new_content">{{ message.content }}</textarea>
          <button type="submit">Edit message</button>
          <button type="submit" formaction="/delete_message/{{ message.id }}" onclick="return confirm('Are you sure you want to delete this message?');" class="delete-button">Delete</button>
        </form>
      {% endif %}
    </div>
  {% endfor %}
</div>

<h3>Post a message</h3>
<form action="/post_message" method="post">
  <div>
    <label>Message:</label>
    <br>
    <textarea name="message"></textarea>
  </div>
  <br>
  <input type="hidden" name="thread_id" value="{{ thread_id }}">
<button type="submit">Post message</button>
</form>

<br>
<a href="/">Back to front page</a>